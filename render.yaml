# Blueprint de Render v1
# Especifica la infraestructura como código para el Sistema de Gestión de Activos.

# La clave 'services' es el punto de entrada principal para definir nuestros componentes.
services:
  # 1. El Servicio Web (nuestra aplicación .NET en un contenedor Docker)
  - type: web
    name: sistema-gestion-activos
    runtime: docker
    dockerfilePath: ./Dockerfile
    
    # Asociamos el disco persistente definido más abajo a este servicio.
    # El disco llamado 'data-disk' se montará en la ruta '/var/data'.
    disk:
      name: data-disk
      mountPath: /var/data
      
    # Variables de entorno para la aplicación.
    envVars:
      - key: ASPNETCORE_ENVIRONMENT
        value: Production
      - key: ASPNETCORE_URLS
        value: http://0.0.0.0:${PORT}
      - key: ConnectionStrings__DefaultConnection
        value: "Data Source=/var/data/sga.db"
      - key: Redis__ConnectionString
        fromService:
          type: redis
          name: cache-redis
          property: connectionString

# La clave 'databases' es usada aquí para definir servicios que no son web, como Redis y discos.
# Aunque Redis no es una base de datos tradicional, se agrupa aquí junto con los discos.
# CORRECCIÓN: En la especificación más reciente, los servicios de addons y discos se definen al mismo nivel.
# Vamos a usar la estructura más aceptada.